imod = 200;

shf = zeros(Nx,size(shp,2));
shf(dret,:) = shp;
pff = zeros(Nx,size(shp,2));
pff(dret,:) = pf;

stary = [    ...
'fx       ', ...
'fy       ', ...
'fz       ', ...
'fthx     ', ...
'fthy     ', ...
'fthz     ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'nacmod   ', ...
'nacmod   ', ...
'drvmod   ', ...
'drvmod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'yaw      ', ...
'azi      ', ...
'dax      ', ...
'bet0     ', ...
'betc     ', ...
'bets     ', ...
'fx       ', ...
'fy       ', ...
'fz       ', ...
'fthx     ', ...
'fthy     ', ...
'fthz     ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'fndmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'towmod   ', ...
'nacmod   ', ...
'nacmod   ', ...
'drvmod   ', ...
'drvmod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'bl0mod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blcmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'blsmod   ', ...
'yaw      ', ...
'azi      ', ...
'dax      ', ...
'bet0     ', ...
'betc     ', ...
'bets     ', ...
'ad0      ', ...
'a10      ', ...
'a20      ', ...
'Vihz0    ', ...
'Viht0    ', ...
'Viz0     ', ...
'Vit0     ', ...
'ad0      ', ...
'a10      ', ...
'a20      ', ...
'Vihz0    ', ...
'Viht0    ', ...
'Viz0     ', ...
'Vit0     ', ...
'ad0      ', ...
'a10      ', ...
'a20      ', ...
'Vihz0    ', ...
'Viht0    ', ...
'Viz0     ', ...
'Vit0     ', ...
'ad0      ', ...
'a10      ', ...
'a20      ', ...
'Vihz0    ', ...
'Viht0    ', ...
'Viz0     ', ...
'Vit0     ', ...
'ad0      ', ...
'a10      ', ...
'a20      ', ...
'Vihz0    ', ...
'Viht0    ', ...
'Viz0     ', ...
'Vit0     ', ...
'ad0      ', ...
'a10      ', ...
'a20      ', ...
'Vihz0    ', ...
'Viht0    ', ...
'Viz0     ', ...
'Vit0     ', ...
'adc      ', ...
'a1c      ', ...
'a2c      ', ...
'Vihzc    ', ...
'Vihtc    ', ...
'Vizc     ', ...
'Vitc     ', ...
'adc      ', ...
'a1c      ', ...
'a2c      ', ...
'Vihzc    ', ...
'Vihtc    ', ...
'Vizc     ', ...
'Vitc     ', ...
'adc      ', ...
'a1c      ', ...
'a2c      ', ...
'Vihzc    ', ...
'Vihtc    ', ...
'Vizc     ', ...
'Vitc     ', ...
'adc      ', ...
'a1c      ', ...
'a2c      ', ...
'Vihzc    ', ...
'Vihtc    ', ...
'Vizc     ', ...
'Vitc     ', ...
'adc      ', ...
'a1c      ', ...
'a2c      ', ...
'Vihzc    ', ...
'Vihtc    ', ...
'Vizc     ', ...
'Vitc     ', ...
'adc      ', ...
'a1c      ', ...
'a2c      ', ...
'Vihzc    ', ...
'Vihtc    ', ...
'Vizc     ', ...
'Vitc     ', ...
'ads      ', ...
'a1s      ', ...
'a2s      ', ...
'Vihzs    ', ...
'Vihts    ', ...
'Vizs     ', ...
'Vits     ', ...
'ads      ', ...
'a1s      ', ...
'a2s      ', ...
'Vihzs    ', ...
'Vihts    ', ...
'Vizs     ', ...
'Vits     ', ...
'ads      ', ...
'a1s      ', ...
'a2s      ', ...
'Vihzs    ', ...
'Vihts    ', ...
'Vizs     ', ...
'Vits     ', ...
'ads      ', ...
'a1s      ', ...
'a2s      ', ...
'Vihzs    ', ...
'Vihts    ', ...
'Vizs     ', ...
'Vits     ', ...
'ads      ', ...
'a1s      ', ...
'a2s      ', ...
'Vihzs    ', ...
'Vihts    ', ...
'Vizs     ', ...
'Vits     ', ...
'ads      ', ...
'a1s      ', ...
'a2s      ', ...
'Vihzs    ', ...
'Vihts    ', ...
'Vizs     ', ...
'Vits     ', ...
'ba0      ', ...
'dba0     ', ...
'bac      ', ...
'dbac     ', ...
'bas      ', ...
'dbas     ', ...
'ya       ', ...
'dya      ', ...
'igd      ', ...
'igq      ', ...
'Vdc      ', ...
'ipd      ', ...
'ipq      ', ...
'imgd     ', ...
'imgq     ', ...
'Psigd    ', ...
'Psigq    ', ...
'wemg     ', ...
'th_m     ', ...
'vmsd     ', ...
'vmsq     ', ...
'Psie     ', ...
'impd     ', ...
'impq     ', ...
'imsd     ', ...
'imsq     ', ...
'vmsd     ', ...
'vmsq     ', ...
'VmDC     ', ...
'PsiDC    ', ...
'PsiQ     ', ...
'Psipd    ', ...
'Psipq    ', ...
'W*       ', ...
'V*       ', ...
'Wm       ', ...
'betm     ', ...
'PsiWb    ', ...
'Pf       ', ...
'PehRSC   ', ...
'ntw1     ', ...
'ntw2     ', ...
'ntb1     ', ...
'ntb2     ', ...
'blp      ', ...
'wgm      ', ...
'iwg      ', ...
'Pem      ', ...
'PsiP     ', ...
'nd1      ', ...
'nd2      ', ...
'vmF      ', ...
'ivmF     ', ...
'vdF      ', ...
'vmS      ', ...
'ivmS     ', ...
'vdS      ', ...
'vmSi     ', ...
'ivmSi    ', ...
'vdSi     ', ...
'Mpsimc   ', ...
'Mspims   ', ...
'PsiMc    ', ...
'PsiMs    '  ...
];

angW = atan2(imag(shf(164,ifrq(imod))),real(shf(164,ifrq(imod))))/pi;
angs = atan2(imag(shf(:,ifrq(imod))),real(shf(:,ifrq(imod))))/pi - angW;
angs(angs>pi) = angs(angs>pi)-2*pi;
angs(angs<-pi) = angs(angs<-pi)+2*pi;
for jdof = 1:Nx
   jc9 = 9*(jdof-1);
   eval(["printf('" stary(jc9+[1:9]) "%8d %12.5f %12.5f %12.5f\\n',jdof,abs(shf(" int2str(jdof) ",ifrq(imod))),angs(jdof),pff(" int2str(jdof) ",ifrq(imod)))"]);
end

%for jdof = 1:Nx
%   jc9 = 9*(jdof-1);
%   eval(["printf('" stary(jc9+[1:9]) "%8d %12.5f %12.5f %12.5f\\n',jdof,abs(shf(" int2str(jdof) ",ifrq(imod))),atan2(imag(shf(" int2str(jdof) ",ifrq(imod))),real(shf(" int2str(jdof) ",ifrq(imod))))/pi,pff(" int2str(jdof) ",ifrq(imod)))"]);
%end
